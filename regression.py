import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
import os
"""
# テスト用CSVのロード
os.chdir("/content/drive/MyDrive/hackason")
data = np.loadtxt("kaiki.csv",delimiter=",", skiprows=1, usecols=(1,2,3),  dtype='float')
"""
def func1(X, *params):
    Y = np.zeros_like(X)
    for i, param in enumerate(params):
        Y = Y + np.array(param*(np.sin(i*i* X )))
    return Y

def func2(X, *params):
    Y = np.zeros_like(X)
    for i, param in enumerate(params):
        Y = Y + np.array( param*np.exp(i*X))
    return Y

def func3(X, *params):
    Y = np.zeros_like(X)
    for i,param in enumerate(params):
        Y = Y + np.array(np.sin(param*np.sqrt(i-np.sin( i*i*X ))))
    return Y

def func(X, *params):
    Y = np.zeros_like(X)
    for i, param in enumerate(params):
        Y = Y + np.array(param * X ** i)
    return Y

def WriteFunc1(X, *params):
    Y = ""
    for i,param in enumerate(params):
        if param >= 0:
            Y = Y + "+"
        Y=Y+str(param)+"*"+"sin("+str(i*i)+"x)"
    print(Y)
    return Y


def getRegressionLineND(fileName):

    D = 100
    t = np.arange(0, 10, 0.1)

    #CSV用
    #y1 = data[:,1]/10.0
    #x = data[:,2]/1.0


    """
    #テスト用関数

    #x=np.array([240, 240, 240, 250, 250, 250, 260, 260, 270, 270, 270, 270, 270, 280, 280, 280, 280, 290, 290, 290, 290, 300, 300, 300, 300, 310, 310, 310, 310, 320, 320, 320, 320, 330, 330, 330, 330, 340, 340, 340, 340, 350, 350, 350, 350, 360, 360, 360, 360, 370, 370, 370, 380, 380, 390, 390, 400, 400, 410, 410, 420, 420, 430, 430, 440, 440, 450, 450, 460, 460, 470, 470, 480, 480, 490, 490, 500, 500, 510, 510, 520, 520, 530, 530, 540, 540, 550, 550, 550, 560, 560, 560, 570, 570, 570, 580, 580, 580, 590, 590, 590, 600, 600, 600, 610, 610, 610, 620])
    #y1=np.array([347, 357, 393, 329, 339, 406, 318, 416, 113, 123, 167, 309, 422, 98, 179, 301, 427, 83, 190, 294, 434, 73, 200, 287, 442, 68, 209, 281, 448, 66, 217, 277, 454, 64, 226, 274, 462, 62, 237, 272, 470, 59, 246, 269, 475, 57, 254, 267, 480, 56, 260, 483, 54, 488, 54, 491, 54, 494, 54, 496, 55, 496, 55, 493, 55, 486, 56, 479, 58, 471, 61, 463, 63, 455, 66, 444, 68, 431, 72, 416, 80, 404, 89, 394, 99, 381, 112, 122, 363, 129, 139, 350, 151, 161, 337, 179, 189, 323, 204, 214, 310, 232, 242, 301, 261, 271, 292, 283])
    #y1=np.array([  16, 17, 18, 19, 20, 21, 22, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 28, 28, 28, 28, 27, 27, 27, 26, 26, 25, 25, 24, 23, 22, 22, 21, 21, 21, 21, 22, 22, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 23, 23, 23, 22, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 12, 11, 11, 10, 10, 9, 9, 9, 9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 6, 5, 4])*0.05
    #x=np.array([ 30.01, 30.02, 30.03, 30.04, 30.05, 30.06, 29.01, 29.02, 29.03, 28.01, 28.02, 27.01, 27.02, 26.01, 26.02, 25.01, 24.01, 23.01, 22.01, 21.01, 20.01, 19.01, 18.01, 17.01, 16.01, 15.01, 14.01, 13.01, 12.01, 11.01, 10.01, 9.01, 8.01, 7.01, 6.01, 5.01, 5.02, 4.01, 4.02, 3.01, 3.02, 3.03, 3.04, 4.001, 4.002, 5.001, 6.001, 7.001, 7.002, 8.001, 9.001, 10.001, 11.001, 12.001, 13.001, 14.001, 15.001, 16.001, 17.001, 18.001, 19.001, 20.001, 21.001, 22.001, 23.001, 23.002, 24.001, 24.002, 25.001, 25.002, 25.003, 25.004, 25.005, 25.006, 25.007, 25.008, 25.009, 24.001, 24.002, 23.001, 23.002, 22.001, 22.002, 21.001, 20.001, 19.001, 18.001, 17.001, 16.001, 15.001, 14.001, 13.001, 12.001, 11.001, 10.001, 9.001, 8.001, 7.001, 6.001, 5.001, 4.001, 4.002, 3.001, 4.003])*0.05
    #y1=np.array( [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 33, 33, 34, 34, 35, 35, 36, 37, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 47, 48, 49, 49, 50, 50, 51, 51, 52, 52, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 57, 57, 56, 55, 54, 54, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 52, 52, 52, 52, 51, 51, 50, 50, 50, 49, 49, 49, 48, 48, 47, 47, 46, 46, 45, 44, 43, 42, 41, 40, 39, 39, 38, 37, 37, 36, 36, 35, 35, 34, 34, 33, 33, 32, 32, 31, 31, 30, 30, 29, 29, 28, 28, 27, 27, 27, 26, 26, 26, 25, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 25, 24, 23, 22, 22, 22, 21, 21, 21, 21] )
    #x=np.array( [15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 42.02, 43, 43.02, 44, 44.02, 45, 45.02, 46, 46.02, 47, 47.02, 48, 49, 49.02, 50, 50.02, 51, 51.02, 51.04, 52, 52.02, 53, 53.02, 54, 54.02, 54.04, 55, 55.02, 55.04, 55.06, 56, 56.02, 56.04, 56.06, 56.08, 55.08, 55.1, 54.06, 54.08, 54.1, 53.04, 53.06, 52.04, 52.06, 51.06, 51.08, 50.04, 50.06, 49.04, 48.02, 48.04, 47.04, 47.06, 46.04, 45.04, 44.04, 43.04, 42.04, 41.02, 40.02, 39.02, 38.02, 37.02, 36.02, 35.02, 34.02, 33.02, 32.02, 31.02, 30.02, 29.02, 28.02, 27.02, 26.02, 25.02, 24.02, 23.02, 22.02, 21.02, 20.02, 19.02, 18.02, 17.02, 16.02, 15.02, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 5.02, 4, 4.02, 5.04, 5.06, 6.02, 7.02, 8.02, 9.02, 10.02, 11.02, 12.02, 13.02, 14.02, 15.04, 16.04, 17.04, 18.04, 19.04, 20.04, 21.04, 22.04, 23.04, 24.04, 25.04, 26.04, 27.04, 28.04, 29.04, 30.04, 31.04, 32.04, 33.04, 34.04, 35.04, 36.04, 37.04, 38.04, 39.04, 40.04, 41.04, 42.06, 43.06, 43.08, 44.06, 45.06, 45.08, 46.06, 47.08, 47.1, 48.06, 48.08, 49.06, 49.08, 50.08, 50.1, 51.1, 51.12, 51.14, 50.12, 50.14, 50.16, 49.1, 49.12, 49.14, 48.1, 48.12, 47.12, 47.14, 46.08, 46.1, 45.1, 45.12, 44.08, 44.1, 43.1, 43.12, 42.08, 42.1, 41.06, 41.08, 40.06, 40.08, 39.06, 39.08, 38.06, 37.06, 36.06, 35.06, 34.06, 33.06, 32.06, 31.06, 30.06, 29.06, 28.06, 27.06, 26.06, 25.06, 24.06, 23.06, 22.06, 21.06, 20.06, 19.06, 18.06, 17.06, 16.06, 15.06, 14.04, 13.04, 12.04, 11.04, 10.04, 9.04, 8.04, 8.06, 8.08, 8.1, 8.12, 9.06, 10.06, 11.06, 12.06, 13.06, 14.06] )
    #y1=np.array( [20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 33, 33, 34, 34, 35, 35, 36, 37, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 47, 48, 49, 49, 50, 50, 51, 51, 52, 52, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 57, 57, 56, 55, 54, 54, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 52, 52, 52, 52, 51, 51, 50, 50, 50, 49, 49, 49, 48, 48, 47, 47, 46, 46, 45, 44, 43, 42, 41, 40, 39, 39, 38, 37, 37, 36, 36, 35, 35, 34, 34, 33, 33, 32, 32, 31, 31, 30, 30, 29, 29, 28, 28, 27, 27, 27, 26, 26, 26, 25, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 25, 24, 23, 22, 22, 22, 21, 21, 21, 21] )
    #x=np.array( [15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 42.001, 43, 43.001, 44, 44.001, 45, 45.001, 46, 46.001, 47, 47.001, 48, 49, 49.001, 50, 50.001, 51, 51.001, 51.002, 52, 52.001, 53, 53.001, 54, 54.001, 54.002, 55, 55.001, 55.002, 55.003, 56, 56.001, 56.002, 56.003, 56.004, 55.004, 55.005, 54.003, 54.004, 54.005, 53.002, 53.003, 52.002, 52.003, 51.003, 51.004, 50.002, 50.003, 49.002, 48.001, 48.002, 47.002, 47.003, 46.002, 45.002, 44.002, 43.002, 42.002, 41.001, 40.001, 39.001, 38.001, 37.001, 36.001, 35.001, 34.001, 33.001, 32.001, 31.001, 30.001, 29.001, 28.001, 27.001, 26.001, 25.001, 24.001, 23.001, 22.001, 21.001, 20.001, 19.001, 18.001, 17.001, 16.001, 15.001, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 5.001, 4, 4.001, 5.002, 5.003, 6.001, 7.001, 8.001, 9.001, 10.001, 11.001, 12.001, 13.001, 14.001, 15.002, 16.002, 17.002, 18.002, 19.002, 20.002, 21.002, 22.002, 23.002, 24.002, 25.002, 26.002, 27.002, 28.002, 29.002, 30.002, 31.002, 32.002, 33.002, 34.002, 35.002, 36.002, 37.002, 38.002, 39.002, 40.002, 41.002, 42.003, 43.003, 43.004, 44.003, 45.003, 45.004, 46.003, 47.004, 47.005, 48.003, 48.004, 49.003, 49.004, 50.004, 50.005, 51.005, 51.006, 51.007, 50.006, 50.007, 50.008, 49.005, 49.006, 49.007, 48.005, 48.006, 47.006, 47.007, 46.004, 46.005, 45.005, 45.006, 44.004, 44.005, 43.005, 43.006, 42.004, 42.005, 41.003, 41.004, 40.003, 40.004, 39.003, 39.004, 38.003, 37.003, 36.003, 35.003, 34.003, 33.003, 32.003, 31.003, 30.003, 29.003, 28.003, 27.003, 26.003, 25.003, 24.003, 23.003, 22.003, 21.003, 20.003, 19.003, 18.003, 17.003, 16.003, 15.003, 14.002, 13.002, 12.002, 11.002, 10.002, 9.002, 8.002, 8.003, 8.004, 8.005, 8.006, 9.003, 10.003, 11.003, 12.003, 13.003, 14.003] )
    #y1=np.array( [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 32, 32, 32, 33, 33, 33, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 38, 38, 38, 39, 39, 40, 40, 41, 41, 42, 42, 43, 44, 44, 45, 45, 46, 47, 47, 48, 49, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 74, 75, 76, 76, 77, 78, 78, 79, 79, 80, 80, 81, 81, 82, 82, 83, 83, 83, 84, 84, 85, 85, 85, 86, 86, 86, 87, 87, 87, 88, 88, 88, 89, 89, 89, 89, 89, 90, 90, 90, 90, 90, 90, 91, 91, 92, 92, 93, 93, 93, 93, 92, 92, 92, 91, 91, 90, 90, 90, 90, 90, 89, 89, 88, 87, 87, 86, 86, 85, 85, 84, 84, 83, 83, 82, 82, 81, 81, 80, 80, 79, 79, 78, 78, 77, 77, 76, 76, 75, 75, 74, 74, 73, 73, 72, 71, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 43, 42, 41, 41, 40, 40, 39, 39, 38, 38, 37, 37, 36, 36, 36, 35, 35, 34, 34, 34, 33, 33, 33, 32, 32, 31, 31, 31, 31, 35, 35, 35, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 36, 37, 37, 37, 38, 38, 39, 39, 39, 40, 40, 40, 41, 41, 42, 42, 43, 43, 43, 44, 44, 45, 46, 46, 47, 47, 48, 49, 49, 50, 51, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 73, 74, 75, 75, 76, 76, 77, 77, 78, 78, 79, 79, 79, 80, 80, 81, 81, 81, 82, 82, 82, 83, 83, 83, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 84, 84, 84, 83, 83, 82, 82, 81, 81, 80, 80, 79, 79, 78, 78, 77, 77, 76, 76, 75, 75, 74, 74, 73, 73, 72, 72, 71, 70, 70, 69, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 46, 45, 44, 44, 43, 43, 42, 42, 41, 41, 41, 40, 40, 39, 39, 39, 38, 38, 38, 37, 37, 36, 36, 36, 36, 36] )
    #x=np.array( [35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 60.001, 61, 62, 62.001, 63, 64, 64.001, 65, 65.001, 66, 67, 67.001, 68, 68.001, 69, 69.001, 70, 70.001, 71, 71.001, 71.002, 72, 72.001, 73, 73.001, 73.002, 74, 74.001, 74.002, 75, 75.001, 75.002, 76, 76.001, 76.002, 77, 77.001, 77.002, 77.003, 78, 78.001, 78.002, 78.003, 78.004, 78.005, 78.006, 78.007, 78.008, 78.009, 77.004, 77.005, 77.006, 77.007, 76.003, 76.004, 75.003, 75.004, 75.005, 74.003, 74.004, 74.005, 73.003, 73.004, 72.002, 72.003, 71.003, 71.004, 70.002, 70.003, 69.002, 69.003, 68.002, 67.002, 67.003, 66.001, 66.002, 65.002, 64.002, 64.003, 63.001, 62.002, 61.001, 60.002, 59.001, 58.001, 57.001, 56.001, 55.001, 54.001, 53.001, 52.001, 51.001, 50.001, 49.001, 48.001, 47.001, 46.001, 45.001, 45.002, 44.001, 44.002, 43.001, 43.002, 42.001, 41.001, 40.001, 40.002, 39.001, 38.001, 38.002, 37.001, 37.002, 36.001, 35.001, 34, 33, 33.001, 32, 32.001, 32.002, 31, 31.001, 30, 30.001, 29, 29.001, 28, 28.001, 27, 27.001, 26, 26.001, 25, 25.001, 24, 24.001, 23, 23.001, 22, 22.001, 21, 21.001, 20, 20.001, 19, 19.001, 18, 18.001, 17, 17.001, 17.002, 16, 16.001, 15, 15.001, 15.002, 14, 14.001, 14.002, 14.003, 14.004, 13, 13.001, 13.002, 13.003, 13.004, 13.005, 13.006, 13.007, 13.008, 13.009, 13.01, 13.011, 13.012, 13.013, 14.005, 14.006, 14.007, 15.003, 15.004, 16.002, 16.003, 16.004, 17.003, 17.004, 18.002, 18.003, 19.002, 19.003, 20.002, 20.003, 21.002, 21.003, 22.002, 23.002, 23.003, 24.002, 24.003, 25.002, 26.002, 26.003, 27.002, 28.002, 29.002, 30.002, 31.002, 32.003, 33.002, 34.001, 38.003, 39.002, 40.003, 41.002, 42.002, 43.003, 44.003, 45.003, 46.002, 47.002, 48.002, 49.002, 50.002, 51.002, 52.002, 53.002, 54.002, 55.002, 56.002, 57.002, 58.002, 59.002, 59.003, 60.003, 61.002, 61.003, 62.003, 62.004, 63.002, 63.003, 64.004, 65.003, 65.004, 66.003, 66.004, 66.005, 67.004, 67.005, 68.003, 68.004, 68.005, 69.004, 69.005, 69.006, 70.004, 70.005, 71.005, 71.006, 71.007, 72.004, 72.005, 72.006, 72.007, 73.005, 73.006, 73.007, 73.008, 73.009, 73.01, 73.011, 73.012, 73.013, 72.008, 72.009, 72.01, 71.008, 71.009, 70.006, 70.007, 70.008, 69.007, 69.008, 68.006, 68.007, 67.006, 67.007, 66.006, 66.007, 65.005, 64.005, 64.006, 63.004, 63.005, 62.005, 61.004, 60.004, 59.004, 58.003, 57.003, 56.003, 55.003, 54.003, 53.003, 52.003, 51.003, 50.003, 49.003, 48.003, 47.003, 46.003, 45.004, 44.004, 43.004, 42.003, 41.003, 40.004, 39.003, 38.004, 37.003, 37.004, 36.002, 35.002, 35.003, 34.002, 34.003, 33.003, 33.004, 32.004, 32.005, 31.003, 31.004, 30.003, 30.004, 29.003, 29.004, 28.003, 28.004, 27.003, 27.004, 26.004, 26.005, 25.003, 25.004, 24.004, 24.005, 23.004, 23.005, 23.006, 22.003, 22.004, 21.004, 21.005, 21.006, 20.004, 20.005, 20.006, 19.004, 19.005, 19.006, 19.007, 19.008, 19.009, 18.004, 18.005, 18.006, 18.007, 18.008, 18.009, 18.01, 18.011, 18.012, 19.01, 19.011, 19.012, 20.007, 20.008, 20.009, 21.007, 21.008, 22.005, 22.006, 23.007, 23.008, 24.006, 25.005, 25.006, 26.006, 26.007, 27.005, 28.005, 28.006, 29.005, 30.005, 31.005, 32.006, 33.005, 34.004, 35.004, 36.003, 37.005] )
    #y1=np.array( [14, 14, 14, 14, 14, 15, 15, 16, 17, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 24, 25, 25, 26, 26, 27, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 33, 33, 34, 34, 35, 35, 36, 37, 37, 38, 39, 39, 40, 40, 41, 41, 42, 42, 41, 41, 40, 39, 38, 37, 37, 36, 36, 35, 34, 34, 33, 32, 32, 31, 31, 30, 30, 29, 28, 28, 27, 27, 26, 26, 25, 25, 24, 24, 23, 23, 22, 22, 22, 21, 21, 20, 20, 20, 19, 19, 19, 18, 18, 17, 17, 17, 16, 16, 16, 15, 15, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 23, 23, 24, 24, 24, 25, 25, 25, 26, 26, 26, 27, 27, 28, 28, 28, 29, 29, 30, 31, 32, 33, 34, 34, 34, 34, 34, 33, 33, 32, 32, 31, 31, 31, 30, 30, 30, 29, 29, 29, 28, 28, 27, 27, 27, 26, 26, 26, 25, 25, 25, 25, 25, 24, 24, 24, 24, 24, 24, 24, 24, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 22, 22, 21, 20, 19, 19, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 39, 39, 40, 40, 41, 41, 42, 42, 43, 43, 44, 45, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 75, 76, 77, 77, 78, 78, 79, 79, 80, 81, 81, 82, 82, 83, 83, 84, 84, 84, 85, 85, 86, 86, 86, 87, 87, 88, 88, 88, 89, 89, 90, 90, 90, 90, 90, 91, 91, 91, 91, 91, 91, 91, 91, 90, 90, 90, 89, 89, 89, 88, 88, 87, 86, 85, 84, 84, 84, 84, 83, 83, 82, 82, 81, 80, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 53, 52, 51, 51, 50, 49, 49, 48, 47, 47, 46, 46, 45, 45, 44, 44, 43, 43, 42, 42, 41, 41, 40, 40, 39, 39, 38, 38, 38, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 43, 44, 44, 44, 45, 45, 46, 46, 47, 48, 48, 49, 49, 50, 51, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 75, 76, 77, 77, 78, 78, 79, 80, 81, 81, 81, 82, 82, 83, 83, 83, 84, 84, 84, 84, 84, 83, 83, 83, 82, 82, 81, 81, 80, 80, 79, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 48, 47, 46, 46, 45, 45, 44, 44, 43, 43, 42, 42, 42, 42, 42, 42, 42, 43, 43, 43, 44, 44, 45, 46, 46, 47, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 72, 73, 73, 74, 75, 75, 76, 76, 77, 78, 78, 79, 79, 80, 80, 80, 81, 81, 82, 82, 82, 83, 83, 83, 84, 84, 85, 85, 85, 85, 86, 86, 86, 85, 85, 84, 83, 83, 82, 82, 81, 80, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 57, 56, 55, 54, 53, 53, 52, 51, 51, 50, 49, 49, 48, 48, 47, 47, 46, 46, 45, 45, 44, 44, 43, 43, 43, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 48, 48, 49, 49, 50, 50, 51, 51, 52, 53, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 74, 75, 75, 76, 76, 77, 77, 78, 78, 79, 79, 79, 78, 78, 77, 77, 76, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 49, 48, 48, 96, 96, 96, 96, 96, 96, 96, 96, 97, 97, 97, 97, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 99, 99, 99, 99, 99, 99, 98, 98, 97, 97, 97, 96, 96, 96, 95, 95, 95, 95, 95, 95, 95, 96, 96, 97, 98, 99, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 102, 102, 103, 103, 103, 103, 104, 104, 104, 104, 104, 104, 104, 104, 104, 103, 103, 103, 103, 103, 103, 103, 102, 102, 102, 102, 101, 101, 101, 101, 101, 101, 100, 100, 99, 98, 97, 97] )
    #x=np.array( [83, 84, 85, 86, 87, 87.001, 88, 88.001, 88.002, 88.003, 87.002, 87.003, 86.001, 85.001, 85.002, 84.001, 83.001, 83.002, 82, 82.001, 81, 80, 80.001, 79, 78, 78.001, 77, 76, 76.001, 75, 75.001, 74, 74.001, 73, 72, 72.001, 71, 71.001, 70, 70.001, 69, 69.001, 68, 68.001, 68.002, 67, 67.001, 66, 66.001, 65, 65.001, 65.002, 64, 64.001, 64.002, 63, 63.001, 62, 62.001, 61, 60, 59, 59.001, 58, 58.001, 58.002, 58.003, 58.004, 59.002, 59.003, 60.001, 60.002, 60.003, 61.001, 61.002, 61.003, 62.002, 62.003, 63.002, 63.003, 64.003, 64.004, 64.005, 65.003, 65.004, 66.002, 66.003, 67.002, 67.003, 68.003, 68.004, 69.002, 69.003, 70.002, 70.003, 71.002, 72.002, 72.003, 73.001, 73.002, 74.002, 75.002, 75.003, 76.002, 77.001, 77.002, 78.002, 78.003, 79.001, 80.002, 80.003, 81.001, 82.002, 82.003, 83.003, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 43.001, 44, 45, 45.001, 46, 47, 47.001, 48, 48.001, 49, 50, 50.001, 51, 51.001, 52, 52.001, 51.002, 51.003, 50.002, 49.001, 48.002, 47.002, 47.003, 46.001, 46.002, 45.002, 45.003, 44.001, 43.002, 43.003, 42.001, 41.001, 41.002, 40.001, 39.001, 38.001, 37.001, 36.001, 35.001, 34.001, 33.001, 32.001, 31.001, 30.001, 29.001, 28.001, 27.001, 26.001, 25.001, 24.001, 23.001, 22.001, 21.001, 20.001, 19.001, 18.001, 17.001, 16.001, 15.001, 14.001, 13.001, 12.001, 11.001, 10.001, 9.001, 8.001, 8.002, 7, 7.001, 7.002, 7.003, 8.003, 71.003, 72.004, 73.003, 74.003, 75.004, 76.003, 77.003, 78.004, 79.002, 80.004, 81.002, 82.004, 82.005, 83.004, 83.005, 84.002, 84.003, 85.003, 85.004, 86.002, 86.003, 87.004, 87.005, 87.006, 88.004, 88.005, 88.006, 89, 89.001, 89.002, 90, 90.001, 90.002, 90.003, 90.004, 91, 91.001, 91.002, 91.003, 91.004, 91.005, 91.006, 91.007, 91.008, 91.009, 91.01, 91.011, 91.012, 91.013, 90.005, 90.006, 90.007, 89.003, 89.004, 89.005, 88.007, 88.008, 88.009, 87.007, 87.008, 86.004, 86.005, 85.005, 85.006, 85.007, 84.004, 84.005, 83.006, 83.007, 82.006, 82.007, 81.003, 80.005, 80.006, 79.003, 79.004, 78.005, 77.004, 77.005, 76.004, 75.005, 74.004, 73.004, 72.005, 71.004, 70.004, 69.004, 68.005, 67.004, 66.004, 65.005, 64.006, 63.004, 62.004, 61.004, 60.004, 59.004, 58.005, 57, 56, 55, 55.001, 54, 53, 53.001, 52.002, 52.003, 51.004, 52.004, 52.005, 53.002, 54.001, 55.002, 55.003, 56.001, 56.002, 55.004, 55.005, 54.002, 54.003, 53.003, 53.004, 53.005, 53.006, 52.006, 52.007, 52.008, 52.009, 52.01, 52.011, 52.012, 52.013, 52.014, 52.015, 52.016, 53.007, 53.008, 53.009, 54.004, 54.005, 54.006, 55.006, 55.007, 56.003, 56.004, 56.005, 57.001, 57.002, 57.003, 58.006, 58.007, 58.008, 59.005, 59.006, 59.007, 60.005, 60.006, 61.005, 61.006, 62.005, 62.006, 63.005, 63.006, 64.007, 64.008, 65.006, 65.007, 66.005, 66.006, 67.005, 67.006, 68.006, 68.007, 69.005, 70.005, 21.002, 22.002, 23.002, 24.002, 25.002, 26.002, 27.002, 28.002, 29.002, 30.002, 31.002, 32.002, 33.002, 34.002, 35.002, 35.003, 36.002, 37.002, 37.003, 38.002, 38.003, 39.002, 39.003, 39.004, 40.002, 40.003, 41.003, 41.004, 41.005, 42.002, 42.003, 42.004, 43.004, 43.005, 43.006, 43.007, 44.002, 44.003, 44.004, 44.005, 44.006, 44.007, 44.008, 43.008, 43.009, 43.01, 43.011, 43.012, 42.005, 42.006, 42.007, 41.006, 41.007, 41.008, 40.004, 40.005, 40.006, 39.005, 39.006, 38.004, 38.005, 37.004, 37.005, 36.003, 35.004, 35.005, 34.003, 34.004, 33.003, 32.003, 31.003, 30.003, 29.003, 28.003, 27.003, 26.003, 25.003, 24.003, 24.004, 23.003, 23.004, 22.003, 22.004, 21.003, 21.004, 20.002, 20.003, 19.002, 19.003, 19.004, 18.002, 18.003, 17.002, 17.003, 17.004, 17.005, 16.002, 16.003, 16.004, 16.005, 16.006, 15.002, 15.003, 15.004, 15.005, 15.006, 15.007, 14.002, 14.003, 14.004, 14.005, 14.006, 14.007, 15.008, 15.009, 15.01, 15.011, 16.007, 16.008, 16.009, 17.006, 17.007, 18.004, 18.005, 19.005, 19.006, 20.004, 72.006, 73.005, 74.005, 75.006, 76.005, 77.006, 78.006, 78.007, 79.005, 80.007, 80.008, 81.004, 81.005, 81.006, 82.008, 82.009, 83.008, 83.009, 83.01, 84.006, 84.007, 84.008, 85.008, 85.009, 85.01, 85.011, 85.012, 85.013, 85.014, 86.006, 86.007, 86.008, 86.009, 86.01, 86.011, 86.012, 86.013, 85.015, 85.016, 85.017, 85.018, 85.019, 84.009, 84.01, 83.011, 83.012, 83.013, 82.01, 82.011, 81.007, 81.008, 81.009, 80.009, 80.01, 79.006, 79.007, 78.008, 77.007, 77.008, 76.006, 76.007, 75.007, 74.006, 74.007, 73.006, 72.007, 71.005, 70.006, 69.006, 68.008, 67.007, 66.007, 65.008, 64.009, 63.007, 63.008, 62.007, 62.008, 62.009, 61.007, 61.008, 60.007, 60.008, 60.009, 59.008, 59.009, 58.009, 58.01, 58.011, 58.012, 57.004, 57.005, 57.006, 57.007, 57.008, 57.009, 57.01, 57.011, 58.013, 58.014, 58.015, 58.016, 59.01, 59.011, 59.012, 60.01, 60.011, 61.009, 61.01, 61.011, 62.01, 62.011, 63.009, 63.01, 63.011, 64.01, 64.011, 64.012, 65.009, 65.01, 66.008, 66.009, 67.008, 67.009, 68.009, 68.01, 69.007, 69.008, 70.007, 70.008, 71.006, 72.008, 22.005, 23.005, 24.005, 25.004, 26.004, 27.004, 28.004, 29.004, 30.004, 31.004, 32.004, 32.005, 33.004, 33.005, 34.005, 34.006, 35.006, 35.007, 36.004, 36.005, 36.006, 37.006, 37.007, 38.006, 38.007, 38.008, 38.009, 38.01, 38.011, 38.012, 38.013, 38.014, 38.015, 38.016, 38.017, 38.018, 38.019, 37.008, 37.009, 37.01, 36.007, 36.008, 36.009, 35.008, 35.009, 34.007, 34.008, 33.006, 33.007, 32.006, 32.007, 31.005, 30.005, 29.005, 28.005, 27.005, 26.005, 26.006, 25.005, 25.006, 24.006, 24.007, 24.008, 23.006, 23.007, 22.006, 22.007, 22.008, 21.005, 21.006, 21.007, 21.008, 21.009, 21.01, 20.005, 20.006, 20.007, 20.008, 20.009, 20.01, 20.011, 19.007, 19.008, 19.009, 20.012, 20.013, 20.014, 20.015, 21.011, 21.012, 22.009, 27.006, 28.006, 29.006, 30.006, 31.006, 32.008, 33.008, 34.009, 35.01, 36.01, 37.011, 38.02, 39.007, 40.007, 41.009, 42.008, 43.013, 44.009, 45.004, 46.003, 47.004, 48.003, 49.002, 50.003, 51.005, 52.017, 53.01, 54.007, 55.008, 56.006, 56.007, 57.012, 58.017, 58.018, 59.013, 60.012, 61.012, 62.012, 63.012, 64.013, 65.011, 66.01, 67.01, 67.011, 68.011, 68.012, 69.009, 68.013, 68.014, 67.012, 66.011, 65.012, 64.014, 63.013, 62.013, 61.013, 61.014, 60.013, 59.014, 59.015, 58.019, 58.02, 57.013, 56.008, 55.009, 54.008, 53.011, 52.018, 51.006, 50.004, 49.003, 48.004, 47.005, 46.004, 45.005, 44.01, 43.014, 42.009, 41.01, 40.008, 39.008, 38.021, 37.012, 36.011, 35.011, 34.01, 33.009, 32.009, 31.007, 30.007, 29.007, 28.007, 27.007, 27.008, 26.007, 26.008, 27.009] )

    #かーじおいど
    #a = 1.0
    #x = a * (1 + np.cos(t)) * np.cos(t)
    #y1 = a * (1 + np.cos(t)) * np.sin(t)
    """
    #y1=np.array( [14, 15, 18, 20, 22, 24, 26, 28, 30, 33, 36, 39, 42, 39, 36, 32, 30, 27, 24, 22, 20, 18, 16, 18, 18, 19, 19, 20, 21, 22, 24, 26, 28, 31, 34, 32, 30, 29, 27, 25, 24, 24, 23, 23, 20, 37, 37, 39, 41, 44, 48, 53, 58, 63, 68, 73, 77, 79, 82, 84, 86, 88, 90, 91, 91, 89, 86, 84, 81, 76, 71, 66, 61, 56, 52, 49, 46, 43, 41, 38, 42, 42, 42, 44, 47, 50, 54, 59, 64, 69, 74, 77, 81, 83, 84, 83, 80, 77, 72, 67, 62, 57, 52, 48, 45, 42, 42, 44, 47, 51, 56, 61, 66, 71, 74, 77, 80, 82, 83, 85, 85, 82, 78, 73, 68, 63, 58, 54, 51, 48, 45, 43, 47, 47, 49, 51, 55, 60, 65, 70, 74, 77, 79, 77, 73, 68, 63, 58, 53, 49, 96, 96, 98, 98, 99, 99, 97, 95, 95, 99, 100, 101, 103, 104, 104, 103, 102, 101, 100] )
    #x=np.array( [83, 87.001, 87.002, 84.001, 81, 78.001, 75.001, 72.001, 69, 67, 65.001, 63, 60, 58.002, 60.001, 61.003, 64.003, 66.002, 68.004, 71.002, 74.002, 77.002, 80.003, 8, 13, 18, 23, 28, 33, 38, 43, 46, 49, 52, 49.001, 46.002, 43.003, 39.001, 34.001, 29.001, 24.001, 19.001, 14.001, 9.001, 7.002, 73.003, 78.004, 82.005, 85.003, 87.005, 89, 90.002, 91.002, 91.007, 91.012, 89.003, 88.009, 85.005, 83.006, 80.005, 77.004, 73.004, 68.005, 63.004, 58.005, 54, 51.004, 55.002, 55.005, 53.005, 52.009, 52.014, 53.009, 55.007, 57.002, 59.005, 61.005, 63.006, 66.005, 68.007, 23.002, 28.002, 33.002, 37.002, 39.003, 41.004, 43.004, 44.003, 44.008, 43.012, 41.007, 39.005, 37.005, 34.004, 29.003, 24.003, 22.004, 19.002, 17.002, 16.003, 15.003, 14.002, 14.007, 16.007, 18.004, 72.006, 77.006, 80.008, 82.009, 84.007, 85.011, 86.007, 86.012, 85.018, 83.012, 81.008, 79.007, 76.007, 72.007, 67.007, 63.008, 61.008, 59.009, 57.004, 57.009, 58.015, 60.01, 62.01, 64.01, 66.008, 68.01, 71.006, 25.004, 30.004, 33.005, 36.004, 38.006, 38.011, 38.016, 37.009, 35.008, 33.007, 29.005, 25.005, 23.006, 21.005, 21.01, 20.009, 19.009, 21.011, 29.006, 34.009, 39.007, 44.009, 49.002, 54.007, 58.017, 62.012, 67.01, 68.013, 64.014, 60.013, 57.013, 52.018, 47.005, 42.009, 37.012, 32.009, 27.007] )
    #y1=np.array( [4, 4, 5, 7, 8, 8, 12, 13, 12, 10, 9, 10, 10, 11, 12, 11, 7, 7, 5, 5, 17, 18, 19, 21, 23, 25, 27, 30, 33, 38, 43, 48, 53, 58, 63, 66, 68, 70, 71, 70, 68, 66, 63, 61, 57, 54, 49, 44, 39, 34, 29, 25, 24, 20, 18, 23, 24, 26, 28, 30, 33, 36, 41, 46, 51, 56, 61, 64, 66, 66, 64, 62, 59, 56, 52, 48, 43, 38, 33, 28, 25, 24, 25, 27, 30, 33, 38, 43, 48, 53, 57, 60, 63, 65, 66, 66, 65, 62, 59, 54, 49, 44, 39, 34, 29, 27, 25, 30, 33, 36, 41, 46, 51, 55, 58, 61, 61, 61, 58, 53, 48, 43, 38, 33, 30, 67, 70, 73, 76, 79, 81, 83, 85, 87, 89, 91, 94, 93, 91, 89, 87, 85, 83, 80, 77, 74, 71, 67, 74, 78, 80, 82, 84, 86, 87, 88, 89, 90, 90, 89, 86, 85, 85, 84, 83, 82, 80, 78, 77] )
    #x=np.array( [46, 51, 56, 59.001, 63, 68, 67.001, 63.001, 58.002, 55.001, 50.001, 45, 40, 35, 30, 26, 29.001, 34.001, 39.001, 44.001, 61.003, 66.002, 71, 76, 79.001, 82.001, 85, 87, 89, 90.002, 91.004, 91.009, 90.003, 89.003, 88.005, 86.003, 83.002, 80.002, 75.001, 70.001, 67.005, 64.003, 62.004, 59.004, 58.007, 56.004, 54.003, 52.002, 52.007, 52.012, 54.005, 56.007, 52.013, 53.01, 56.008, 66.005, 71.002, 75.002, 78.002, 81.002, 83.004, 85.005, 86.004, 86.009, 85.012, 84.006, 83.009, 81.007, 78.004, 73.003, 70.004, 67.007, 65.007, 63.007, 61.007, 59.008, 58.011, 57.01, 58.013, 60.007, 62.007, 28.002, 33.002, 36.002, 39.002, 41.002, 42.004, 43.006, 44.006, 43.009, 41.005, 39.004, 37.004, 34.004, 29.003, 24, 19, 17.001, 15.001, 14.002, 15.005, 16.003, 17.002, 18.003, 20.002, 23.001, 26.003, 32.004, 34.006, 36.006, 38.007, 38.012, 38.017, 36.007, 34.007, 32.007, 27.006, 22.003, 20.004, 19.007, 20.011, 21.007, 22.006, 24.005, 26.006, 62.01, 64.01, 66.008, 68.011, 70.006, 73.004, 76.005, 79.006, 82.009, 85.018, 88.007, 86.013, 82.01, 79.007, 76.007, 73.006, 70.008, 67.011, 65.012, 63.013, 61.014, 59.014, 58.02, 50.002, 51.005, 48.003, 45.002, 42.008, 37.011, 32.008, 27.008, 22.008, 17.006, 12, 8.001, 8.002, 12.001, 17.007, 22.009, 27.009, 32.009, 37.012, 41.01, 45.004] )
    x=np.array([9, 28, 38, 58, 88, 98, 108, 118, 128, 138, 148, 158, 168, 178, 188, 198, 208, 218, 228, 238, 278, 288, 298])
    y1=np.array([51, 80, 112, 294, 286, 110, 59, 70, 56, 70, 104, 59, 59, 72, 87, 99, 64, 60, 74, 151, 157, 57, 83])
    x=x.astype(float)
    y1=y1.astype(float)
    plt.figure("picture function")


    #plt.plot(x, y1, 'o',label="picture point")
    #plt.plot(x, np.poly1d(np.polyfit(x, y1, D))(x), label="多項式回帰")
    #curve_fitの多項式回帰
    #popt, pcov=curve_fit(func,x, y1, p0=[0]*len(x))
    popt, pcov=curve_fit(func1,x, y1, p0=[1]*len(x))
    plt.plot(x,func1(x,*popt),label="RegressionFunction")
    print(popt)
    print("要素数"+str(len(x)))
    plt.xlabel("num")
    plt.ylabel("f")
    plt.legend()
    plt.savefig("/content/drive/MyDrive/hackason/results/"+fileName+".png")
    # グリッド表示
    plt.grid()

    # グラフ表示
    plt.show()

    WriteFunc1(x,*popt)


def getRegressionLines(fileName,x,y):

    plt.figure("picture function")


    #絵を分裂させてそれぞれを関数にする場合
    for i in range(len(x)){
      popt, pcov=curve_fit(func1,x[i], y[i], p0=[1]*len(x[i]))
      plt.plot(x[i],func1(x[i],*popt),label="Func"+string(i))
      print("Func"+string(i))
      WriteFunc1(x,*popt)
    }
    


if __name__=='__main__':
    fileName=input("保存するファイル名")
    getRegressionLineND(fileName)
